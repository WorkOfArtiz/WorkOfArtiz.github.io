const productDetails=[{name:"regular-duck",label:"Regular duck",price:1300},{name:"regular-duck-box",label:"Regular duck in box",price:1500},{name:"tiny-duck",label:"Small duck at counter",price:550},{name:"small-duck",label:"Next to small ducks (medium)",price:750},{name:"lego-duck",label:"Lego duck",price:1500},{name:"sw-duck",label:"Starwars duck",price:1500},{name:"sb-keychain",label:"Snowball keychain",price:1295},{name:"b-duck",label:"Bobbing duck (b-duck)",price:1200},{name:"ayyg",label:"Eggs",price:850},{name:"bud-duck",label:"Bud duck",price:2500},{name:"bud-duck-small",label:"Bud duck (small)",price:1500},{name:"cab-can",label:"Cabernet canard",price:3450},{name:"duck-stopper",label:"Duck door stopper",price:1900},{name:"duck-bank",label:"Piggy bank",price:2350},{name:"tubbz",label:"TUBBZ duck",price:3950},{name:"star-trek-duck",label:"Star trek duck",price:3950},{name:"dino-duck",label:"Dinosaur duck",price:12900},{name:"top-notch",label:"Top shelf duck",price:4950},{name:"top-notch-chonk",label:"Top shelf duck (big)",price:7900},{name:"ceramic-smoll",label:"Ceramic duck (small, all variants)",price:2495},{name:"ceramic-normal",label:"Ceramic duck (w/o silver)",price:4950},{name:"ceramic-silver",label:"Ceramic duck (silver)",price:5995},{name:"ceramic-chonk",label:"Ceramic duck (big)",price:35e3},{name:"bag-small",label:"Small bag",price:2450},{name:"bag-medium",label:"Medium bag",price:3450},{name:"bag-large",label:"Large bag",price:3450}],discounts=[{name:"Discount 3 Regular ducks for €32",consists_of:{"regular-duck":3},price:3200},{name:"Discount 3 Regular ducks in boxes for €40",consists_of:{"regular-duck-box":3},price:4e3},{name:"Discount 4 Small ducks at counter for €20",consists_of:{"tiny-duck":4},price:2e3},{name:"Discount 4 Next to small ducks (medium) for €20",consists_of:{"small-duck":3},price:2e3}],currencies=[{name:"100 bill",value:1e4,img:"img/100-euro.png",in_stock:!1,type:"bill"},{name:"50 bill",value:5e3,img:"img/50-euro.png",in_stock:!1,type:"bill"},{name:"20 bill",value:2e3,img:"img/20-euro.png",in_stock:!0,type:"bill"},{name:"10 bill",value:1e3,img:"img/10-euro.png",in_stock:!0,type:"bill"},{name:"5 bill",value:500,img:"img/5-euro.png",in_stock:!0,type:"bill"},{name:"2 coin",value:200,img:"img/2-euro.png",in_stock:!0,type:"coin"},{name:"1 coin",value:100,img:"img/1-euro.png",in_stock:!0,type:"coin"},{name:"50 cents",value:50,img:"img/50-cents.png",in_stock:!0,type:"coin"},{name:"20 cents",value:20,img:"img/20-cents.png",in_stock:!0,type:"coin"},{name:"10 cents",value:10,img:"img/10-cents.png",in_stock:!0,type:"coin"},{name:"5 cents",value:5,img:"img/5-cents.png",in_stock:!0,type:"coin"}],productAmounts={},amountChangedListeners=[];function buildProductView(){var e,t=document.getElementById("products"),n=[];for(e of productDetails)productAmounts[e.name]=0,n.push(`<div class="row justify-content-center align-items-center g-2 mb-1" product="${e.name}">
                <div class="col-8">${e.label}</div>
                <div class="col-4 controls">
                    <div class="btn-group" role="group">
                        <button type="button" class="btn btn-success" onclick="incAmount('${e.name}')">+</button>
                        <button type="button" class="btn btn-primary value">0</button>
                        <button type="button" class="btn btn-danger" onclick="decAmount('${e.name}')">-</button>
                    </div>
                </div>
        </div>`);t.innerHTML=n.join("")}function setAmount(e,t){var n;document.querySelector(`#products > div[product='${e}'] button.btn-primary`).innerHTML=t,productAmounts[e]=t;for(n of amountChangedListeners)n(e,t)}function incAmount(e){setAmount(e,productAmounts[e]+1)}function decAmount(e){0!=productAmounts[e]&&setAmount(e,productAmounts[e]-1)}function estimateBills(e){return e<=1e3?1e3:e<=2e3?2e3:e<=5e3?5e3:e<=1e4?1e4:e%100==0?e:100*(1+(e/100|0))}function readPriceFloat(e){var t,n;return e.match(/\d+\.\d{2}/)?([t,n]=e.split("."),100*+t+Math.floor(n)):e.match(/\d+\.\d/)?([t,n]=e.split("."),100*+t+10*+n):e.match(/\d+/)?100*+e:NaN}function formatPriceFloat(e){return Math.floor(e/100)+"."+Math.floor(e/10)%10+e%10}function formatCurrency(e){return"€ "+formatPriceFloat(e).padStart(7)}function rebuildCart(){var t,e,n={...productAmounts},a=[];for(t of discounts){let e=1/0;for(var[c,i]of Object.entries(t.consists_of)){if(n[c]<i){e=0;break}e=Math.min(e,n[c]/i)}if(!(e<1)){var l,o,r=0|e;a.push({label:t.name,individual_price:t.price,amount:r,item_total:r*t.price});for([l,o]of Object.entries(t.consists_of))n[l]-=r*o}}for(e of productDetails)0!=n[e.name]&&a.push({label:e.label,individual_price:e.price,amount:n[e.name],item_total:n[e.name]*e.price});var u,s=[];for(u of a)s.push(`
        <div class="row justify-content-center align-items-center g-2 mb-1" product="regular-duck">
            <div class="col-8">${u.label}</div>
            <div class="col-2 controls">x ${u.amount}</div>
            <div class="col-2 controls"><pre class="mb-0">${formatCurrency(u.item_total)}</pre></div>
        <div>
        `);var m=a.reduce((e,t)=>e+t.item_total,0);0<m?(s.push(`
        <div class="row justify-content-center align-items-center g-2 mb-1" product="regular-duck">
            <div class="col-8"><strong>Total</strong></div>
            <div class="col-2 controls"></div>
            <div class="col-2 controls"><pre class="mb-0">${formatCurrency(m)}</pre></div>
        <div>
        `),document.getElementById("receipt").innerHTML=`
        <div class="card">
            <div class="card-header bg-dark text-light">
                Receipt
            </div>
            <div class="card-body">
                ${s.join("")}
            </div>
        </div>
        `,document.getElementById("total-price").value=formatPriceFloat(m),document.getElementById("money-received").value=formatPriceFloat(estimateBills(m)),calculateChange()):document.getElementById("receipt").innerHTML="No items chosen yet"}function calculateChange(){var e=document.getElementById("total-price"),t=readPriceFloat(e.value),e=(isNaN(t)?e.classList.add("is-invalid"):e.classList.remove("is-invalid"),document.getElementById("money-received")),n=readPriceFloat(e.value);if(isNaN(n)?e.classList.add("is-invalid"):e.classList.remove("is-invalid"),isNaN(n)||isNaN(t))document.getElementById("change").innerHTML="You made a typo above";else if(n<t)document.getElementById("change").innerHTML="Customer didn't pay enough";else if(n==t)document.getElementById("change").innerHTML="Customer paid exactly the right amount";else{let e=n-t;var a,c=[];for(a of currencies)if(a.in_stock&&!(a.value>e)){times=e/a.value|0,e-=times*a.value;var i=`
        <div class="mb-3 col-${"bill"===a.type?4:2}">
            <img class="currency ${a.type}" src="${a.img}">
        </div>
        `;for(let e=0;e<times;e++)c.push(i)}document.getElementById("change").innerHTML=`
        <div class="row">
            ${c.join("")}
        </div>
    `}}window.addEventListener("load",()=>{buildProductView(),rebuildCart(),calculateChange(),document.getElementById("total-price").onkeyup=calculateChange,document.getElementById("money-received").onkeyup=calculateChange,amountChangedListeners.push(rebuildCart)});