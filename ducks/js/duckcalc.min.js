var buildProductView=(()=>{let a=document.getElementById(`products`);let b=[];for(let a of productDetails){productAmounts[a.name]=0;b.push(`<div class="row justify-content-center align-items-center g-2 mb-1" product="${a.name}">
                <div class="col-8">${a.label}</div>
                <div class="col-4 controls">
                    <div class="btn-group" role="group">
                        <button type="button" class="btn btn-success" onclick="incAmount('${a.name}')">+</button>
                        <button type="button" class="btn btn-primary value">0</button>
                        <button type="button" class="btn btn-danger" onclick="decAmount('${a.name}')">-</button>
                    </div>
                </div>
        </div>`)};a.innerHTML=b.join(``)});var formatPriceFloat=(a=>(a/100|0)+ `.`+ (a/b)%b+ ``+ a%b);var calculateChange=(()=>{let h=`is-invalid`,i=`change`,j=0,g=isNaN;let a=document.getElementById(`total-price`);let b=readPriceFloat(a.value);if(g(b)){a.classList.add(h)}else{a.classList.remove(h)};let c=document.getElementById(`money-received`);let d=readPriceFloat(c.value);if(g(d)){c.classList.add(h)}else{c.classList.remove(h)};if(g(d)||g(b)){document.getElementById(i).innerHTML=`You made a typo above`;return}else if(d<b){document.getElementById(i).innerHTML=`Customer didn't pay enough`;return}else if(d==b){document.getElementById(i).innerHTML=`Customer paid exactly the right amount`;return};let e=d- b;let f=[];for(let a of currencies){if(!a.in_stock||a.value>e){continue};times=e/a.value|j;e-=times*a.value;let b=`
        <div class="mb-3 col-${a.type===`bill`?4:2}">
            <img class="currency ${a.type}" src="${a.img}">
        </div>
        `;for(let a=j;a<times;a++){f.push(b)}};document.getElementById(i).innerHTML=`
        <div class="row">
            ${f.join(``)}
        </div>
    `});var setAmount=((a,b)=>{let c=document.querySelector(`#products > div[product='${a}'] button.btn-primary`);c.innerHTML=b;productAmounts[a]=b;for(let c of amountChangedListeners){c(a,b)}});var incAmount=(a=>{setAmount(a,productAmounts[a]+ 1)});var formatCurrency=(a=>`€ `+ formatPriceFloat(a));var decAmount=(a=>{if(productAmounts[a]==0){return};setAmount(a,productAmounts[a]- 1)});var readPriceFloat=(a=>{let b=`.`,d=100,c=0;if(a.match(/\d+\.\d{2}/)){let [e,f]=a.split(b);return (e|c)*d+ (f|c)}else if(a.match(/\d+\.\d/)){let [e,f]=a.split(b);return (e|c)*d+ (f|c)*10}else if(a.match(/\d+/)){return (a|c)*d};return NaN});var rebuildCart=(()=>{let f=0,g=`receipt`,e=Object.entries;let a={...productAmounts};let b=[];for(let c of discounts){let d=Infinity;for(const [b,g] of e(c.consists_off)){if(a[b]<g){d=f;break}else{d=Math.min(d,a[b]/g)}};if(d<1){break};let g=d|f;b.push({label:c.name,individual_price:c.price,amount:g,item_total:g*c.price});for(const [b,d] of e(c.consists_off)){a[b]-=g*d}};for(let c of productDetails){if(a[c.name]==f){continue};b.push({label:c.label,individual_price:c.price,amount:a[c.name],item_total:a[c.name]*c.price})};let c=[];for(let a of b){c.push(`
        <div class="row justify-content-center align-items-center g-2 mb-1" product="regular-duck">
            <div class="col-8">${a.label}</div>
            <div class="col-2 controls">x ${a.amount}</div>
            <div class="col-2 controls">${formatCurrency(a.item_total)}</div>
        <div>
        `)};let d=b.reduce((a,b)=>a+ b.item_total,f);if(d>f){c.push(`
        <div class="row justify-content-center align-items-center g-2 mb-1" product="regular-duck">
            <div class="col-8"><strong>Total</strong></div>
            <div class="col-2 controls"></div>
            <div class="col-2 controls">${formatCurrency(d)}</div>
        <div>
        `);document.getElementById(g).innerHTML=`
        <div class="card">
            <div class="card-header bg-dark text-light">
                Receipt
            </div>
            <div class="card-body">
                ${c.join(``)}
            </div>
        </div>
        `;document.getElementById(`total-price`).value=formatPriceFloat(d);calculateChange()}else{document.getElementById(g).innerHTML=`No items chosen yet`}});const productDetails=[{name:`big-duck`,label:`Big duck`,price:2000},{name:`regular-duck`,label:`Regular duck`,price:1200},{name:`ducktopus`,label:`Duck octopus`,price:1950},{name:`the-doker`,label:`The Duck Joker`,price:1600},{name:`yoduck`,label:`Yoda duck`,price:1600},{name:`duck-keychain`,label:`Duck keychain`,price:500},{name:`duck-duck`,label:`Ducker`,price:1000}];const discounts=[{name:`3 Regular ducks for €30`,consists_off:{"regular-duck":3},price:3000}];const currencies=[{name:`100 bill`,value:10000,img:`img/100-euro.png`,in_stock:!0,type:`bill`},{name:`50 bill`,value:5000,img:`img/50-euro.png`,in_stock:!0,type:`bill`},{name:`20 bill`,value:2000,img:`img/20-euro.png`,in_stock:!0,type:`bill`},{name:`10 bill`,value:1000,img:`img/10-euro.png`,in_stock:!0,type:`bill`},{name:`5 bill`,value:500,img:`img/5-euro.png`,in_stock:!0,type:`bill`},{name:`2 coin`,value:200,img:`img/2-euro.png`,in_stock:!0,type:`coin`},{name:`1 coin`,value:100,img:`img/1-euro.png`,in_stock:!0,type:`coin`},{name:`50 cents`,value:50,img:`img/50-cents.png`,in_stock:!0,type:`coin`},{name:`20 cents`,value:20,img:`img/20-cents.png`,in_stock:!0,type:`coin`},{name:`10 cents`,value:10,img:`img/10-cents.png`,in_stock:!0,type:`coin`},{name:`5 cents`,value:5,img:`img/5-cents.png`,in_stock:!0,type:`coin`}];const productAmounts={};const amountChangedListeners=[];window.onload=(()=>{buildProductView();rebuildCart();calculateChange();document.getElementById(`total-price`).onkeyup=calculateChange;document.getElementById(`money-received`).onkeyup=calculateChange;amountChangedListeners.push(rebuildCart)})